\documentclass{beamer}

\mode<presentation>
{
  \usetheme{Warsaw}
  \useoutertheme{infolines}
  \usecolortheme[RGB={125,173,51}]{structure}
  %\usetheme[height=7mm]{Rochester}
  % or ...

  \setbeamercovered{transparent}
  % or whatever (possibly just delete it)
}

\usepackage{multicol}
\usepackage{verbatim} 
\usepackage{fancyvrb}
\usepackage{listings}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{shapes}
\tikzstyle{block}=[draw opacity=0.7,line width=1.4cm]

\lstloadlanguages{C++}
\lstnewenvironment{code}
	{%\lstset{	numbers=none, frame=lines, basicstyle=\small\ttfamily, }%
	 \csname lst@SetFirstLabel\endcsname}
	{\csname lst@SaveFirstLabel\endcsname}
\lstset{% general command to set parameter(s)
	language=C++, basicstyle=\footnotesize\ttfamily, keywordstyle=\slshape,
	emph=[1]{tipo,usa}, emphstyle={[1]\sffamily\bfseries},
	morekeywords={tint,forn,forsn},
	basewidth={0.47em,0.40em},
	columns=fixed, fontadjust, resetmargins, xrightmargin=5pt, xleftmargin=15pt,
	flexiblecolumns=false, tabsize=2, breaklines,	breakatwhitespace=false, extendedchars=true,
	numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=9pt,
	frame=l, framesep=3pt,
}

\usepackage[spanish]{babel}
% or whatever

\usepackage[latin1]{inputenc}
% or whatever

\usepackage{times}
\usepackage[T1]{fontenc}
% Or whatever. Note that the encoding and the font should match. If T1
% does not look nice, try deleting the line with the fontenc.


\title[IPC] % (optional, use only with long paper titles)
{Dualidad Punto-Línea y Convex Hull Trick}

\author[Agustín Gutiérrez] % (optional, use only with lots of authors)
{~Agustín Santiago Gutiérrez}
% - Give the names in the same order as the appear in the paper.
% - Use the \inst{?} command only if the authors have different
%   affiliation.
\institute[UBA] % (optional, but mostly needed)
{
  %\inst{1}
  Facultad de Ciencias Exactas y Naturales\\
  Universidad de Buenos Aires
}
\date[TC 2018] % (optional, should be abbreviation of conference name)
{Training Camp Argentina 2018}

% Acá se puede insertar el logo de la UBA
% \pgfdeclareimage[height=0.5cm]{university-logo}{university-logo-filename}
% \logo{\pgfuseimage{university-logo}}



% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
%\AtBeginSubsection[]
\AtBeginSection[]
{
  \begin{frame}{Contenidos}
  \footnotesize
%  \begin{multicols}{2} 
    \tableofcontents[currentsection, currentsubsection]
%  \end{multicols}
  \end{frame}
}
%
%\DeclareMathOperator*{\mimin}{min}
%\DeclareMathOperator*{\mimax}{max}

% If you wish to uncover everything in a step-wise fashion, uncomment
% the following command: 

%\beamerdefaultoverlayspecification{<+->}


\begin{document}
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}
\begin{frame}
  \titlepage
\end{frame}

\begin{frame} 
\footnotesize
\frametitle{Contenidos} 
%\begin{multicols}{2} 
\tableofcontents
%\end{multicols}
\end{frame}

\begin{frame}
    \textbf{Advertencia:} Estas diapos no son autocontenidas. Les faltan todos los dibujos (pizarrón), y explicaciones clave.
\end{frame}


\begin{frame}
    ``[...] geometry, however, is not concerned with the relation of the ideas involved in it to objects of experience, but only with the logical \textbf{connection of these ideas among themselves}.''
    \vfill
        {\hfill Albert Einstein, \textit{Relativity: The special and general theory}, 1920}
\end{frame}

\section{Repaso de cápsula convexa (convex hull)}

\begin{frame}{Cápsula convexa}

    \begin{itemize}
        \item La forma que adopta una banda elástica, si la hacemos rodear ``postes'' clavados en los puntos.
        \item Se puede calcular con Graham Scan, en un solo recorrido.
        \item Se puede calcular en dos partes: La \textbf{cápsula superior} y la \textbf{cápsula inferior}.
        \item Ambos algoritmos se basan en ``tener un stack e ir sacando hasta que encaje''.

    \end{itemize}

\end{frame}


\section{Problemas de ejemplo}

\begin{frame}{Problemas de ejemplo}
    \begin{itemize}
%        \item Máxima cantidad de puntos alineados
%        \item Máxima cantidad de rectas concurrentes

%        \item Mínima cantidad de torres necesarias para apilar mesadas
%        \item Máxima cantidad de ``gráficos de rectas incomparables''

%        \item Cantidad de vértices de la cápsula convexa de puntos en el plano
%        \item Cantidad de rectas ``sobre las que pega la lluvia''

%        \item ``A qué altura pega la lluvia para un cierto $x$''
%        \item Ancho de un conjunto de puntos en una cierta dirección


        \item Cantidad de rectas ``sobre las que pega la lluvia''
        \item Ancho de un conjunto de puntos en una cierta dirección
        \item Máxima cantidad de rectas concurrentes
        \item Cantidad de vértices de la cápsula convexa de puntos en el plano
        \item Máxima cantidad de puntos alineados
        \item ``A qué altura pega la lluvia para un cierto $x$''
        \item Máxima cantidad de ``gráficos de rectas incomparables''
        \item Mínima cantidad de torres necesarias para apilar mesadas
    \end{itemize}
    \pause
        \invisible<1>{\hfill \textbf{¿Cuáles de estos se relacionan?} \hfill}
\end{frame}



\begin{frame}{Parejas de problemas duales}

    \begin{itemize}
        \item Máxima cantidad de puntos alineados
        \item Máxima cantidad de rectas concurrentes\\ \ 
        
        \item Mínima cantidad de torres necesarias para apilar mesadas
        \item Máxima cantidad de ``gráficos de rectas incomparables''\\ \ 

        \item Cantidad de vértices de la cápsula convexa de puntos en el plano
        \item Cantidad de rectas ``sobre las que pega la lluvia''\\ \ 

        \item ``A qué altura pega la lluvia para un cierto $x$''
        \item Ancho de un conjunto de puntos en una cierta dirección

    \end{itemize}

    \pause
        \invisible<1>{\hfill \textbf{¿Les parecen igual de fáciles/difíciles los emparejados?} \hfill}

\end{frame}

\section{Dualidad punto línea}

\begin{frame}{Representación de rectas en computadora}

    \begin{itemize}
        \item Idea: ¿Cómo representamos una recta?
        \pause
        \invisible<1>{
                \item Dependiendo del contexto y de cómo la vamos a usar hay muchas maneras.
                \item Para ``cálculos geométricos con rectas y figuras'', en general representaciones con \textbf{vectores} es lo mejor.
            }
        \pause
        \invisible<1-2>{\item Si la recta representa naturalmente una cierta \textit{función lineal} que a veces evaluamos, la \textbf{forma explícita} $y = ax + b$ puede ser más útil.
                      \item Notar que de ser así no tienen sentido las rectas verticales (no son funciones).
        }
    \end{itemize}
    
\end{frame}

\begin{frame}[fragile]{Rectas y puntos en struct}

     \begin{verbatim}
struct Recta
{
    int a,b; // Forma explicita:
             // contiene los puntos (x,y)
             // que cumplen y = ax + b
};

struct Punto
{
    int x,y;
};
\end{verbatim}

\begin{itemize}
        \pause
        \invisible<1>{\item ¿Qué diferencia hay entre ambas?
            }
        \pause
        \invisible<1-2>{\item \small Los nombres. ``Names Don't Constitute Knowledge'' R. Feynman \url{https://www.youtube.com/watch?v=lFIYKmos3-s}} 
\end{itemize}
    
\end{frame}

\begin{frame}{La transformación}

    \begin{itemize}
        \item Transformar rectas en puntos: $y = ax + b \mapsto (a,b)$ 
        \pause
        \invisible<1>{
                \item ¿Eso es todo? ¿Eso es dualidad punto recta?
            }
        \pause
        \invisible<1-2>{\item Sí.
        }
        \pause
        \invisible<1-3>{\item ¿De verdad?
        }
        \pause
        \invisible<1-4>{\item Sí.}
        \pause
        \invisible<1-5>{\item Pero para que sea útil hay que entender la \textbf{relación} entre ellos.
        }
    \end{itemize}
    
\end{frame}

\begin{frame}{Relaciones}

    \begin{itemize}
        \item $y = f(x) = ax + b \Leftrightarrow (a,b) = p$ 
        \pause
        \invisible<1>{
                \item ``rectas no verticales'' = `` funciones lineales'' $\Leftrightarrow$ ``puntos del plano''
            }
        \pause
        \invisible<1-2>{\item ``pendiente mayor'' $\Leftrightarrow$ ``coordenada $x$ mayor''
        }
        \pause
        \invisible<1-3>{\item ``rectas paralelas'' $\Leftrightarrow$ ``alineados en vertical''
        }
        \pause
        \invisible<1-4>{\item ``rectas concurrentes'' $\Leftrightarrow$ ``alineados salvo verticales''
        }
        \pause
        \invisible<1-5>{\item ``$y$'' (o sea $f(x)$ dado $x$) $\Leftrightarrow$ $p \cdot (x,1)$}
        \pause
        \invisible<1-6>{\item ``Mayor $f(x)$'' $\Leftrightarrow$ ``$p$ está más avanzado en la dirección apuntada por $\vec v=(x,1)$''.
        }
        \pause
        \invisible<1-7>{\item \textbf{``Rectas sobre las que pega la lluvia'' $\Leftrightarrow$ ``Cápsula superior''.}
        }
        \pause
        \invisible<1-8>{\item Esta última es la que da el nombre a ``convex hull trick''
                        \item ¡Revisar los problemas anteriores para verificar los emparejamientos!}
    \end{itemize}
    
\end{frame}


\section{Convex Hull Trick}

\begin{frame}{Qué es}

    \begin{itemize}
        \invisible<0-0>{\item Es la técnica que usamos para calcular eficientemente,a partir de un $x$, el valor de  $max_{i=1}^n {f_i(x)}$, si tenemos $n$
                             funciones lineales $f_i$}
        \pause
        \invisible<1-1>{\item Es como tener las ``Rectas donde pega la lluvia'' rápido, que son las que importan. O por dualidad, es como tener la cápsula superior, que son los únicos puntos candidatos a ser los más alejados en una dirección $\vec v=(x,1)$.}
    \end{itemize}
    
\end{frame}

\begin{frame}{Convex Hull Trick offline}

    \begin{itemize}
        \item Si las rectas van apareciendo \textbf{en orden de pendiente}, o si las podemos ordenar libremente, podemos hacer como al construir la cápsula superior: vamos ``descartando hasta que encaje'' del vector de rectas, y siempre tendremos las rectas de lluvia \textbf{ordenadas} (binary search).
    \end{itemize}
    
\end{frame}


\begin{frame}{Convex Hull Trick online}
    \begin{itemize}
        \invisible<0-0>{\item Si las rectas aparecen en forma dinámica y en cualquier orden, podemos tenerlas en un \texttt{set} \textbf{ordenadas por pendiente}, y usar \texttt{lower\_bound} para ver dónde insertar la nueva (si es que hay que hacerlo).}
        \pause
        \invisible<1-1>{\item Podemos usar la dualidad para razonar más fácil en términos de puntos (si así nos resulta más fácil), pues es análogo a mantener la cápsula superior cuando aparecen nuevos puntos: allí los mantendríamos ordenados por coordenada $x$, y luego ``borraríamos adyacentes a cada lado'' hasta que la banda elástica quede ``correctamente tensada''.}
        \pause
        \invisible<1-2>{\item Truco de implementación: suele ser conveniente agregar rectas centinelas en los extremos, con pendientes enormes, para evitar problemas por accesos fuera de rango.}
        \invisible<1-2>{\item Equivalentemente, para trabajar con la cápsula superior de un conjunto de puntos, agregaríamos dos puntos centinela con valores extremos de la coordenada $x$.}

    \end{itemize}
    
\end{frame}


\section{Dualidad intervalo-punto}

\begin{frame}{Otro ejemplo de transformación}
    \begin{itemize}
        \item Consiste en pensar un intervalo $(A,B)$ en la recta numérica, como un punto $(A,B)$ en el plano.
        \item La recta numérica original puede pensarse como la recta $y=x$, que contiene los intervalos de longitud $0$ (puntos).
        \item Todos los intervalos válidos viven en la parte superior $y > x$ del plano.
        \item Los $(A,B)$ con $A > B$ podrían usarse para representar el ``complemento'' de un intervalo: tiene sentido en problemas circulares.

    \end{itemize}
    
\end{frame}

\begin{frame}{Relaciones}
    \begin{itemize}
        \item Un intervalo contiene a otro, si y solo si este último está más ``abajo a la derecha''.
        \item Si imaginamos que el punto de un intervalo lanza una ``sombra'' haba abajo y hacia la derecha, los puntos de la recta $y=x$ cubiertos son exactamente el intervalo original.
        \item Así que dos intervalos se tocan si y solo si sus sombras chocan.
        \item Dado un punto (que representa un intervalo), los puntos de intervalos que se intersecan con él, son los que están en un ``cuadrante'' arriba y a la izquierda de su reflejo por $y=x$.
        \item Para algunos es más fácil visualizar puntos que visualizar intervalos, y la transformación puede facilitar tener algunas ideas clave.
    \end{itemize}
    
\end{frame}

\begin{frame}{Problema de ejemplo}
    \begin{itemize}
        \item Updates: Aparecen y desaparecen puntos con peso. Todos en la parte \textbf{superior} $y > x$ del plano.
        \item Query: Dado un punto del plano en la parte \textbf{inferior} $y < x$, suma de los pesos de los que están arriba y a su izquierda.
        \pause
        \invisible<1>{\item Este problema es el equivalente exacto que resulta al aplicar la dualidad intervalo-punto que vimos, al problema F del TAP 2017}
    \end{itemize}
    
\end{frame}

\end{document}
